<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kafle z Arkusza Google</title>
  <style>
    /* Dodaj stylizację kafli */
    .tile {
      border: 1px solid #ddd;
      padding: 10px;
      margin: 10px;
      width: 300px;
      float: left; /* Kaflowy układ - jeden obok drugiego */
    }

    .tile img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>

<div id="tiles-container"></div>

<script>
// Adres URL publicznego arkusza
// Adres URL publicznego arkusza
const sheetUrl = 'https://docs.google.com/spreadsheets/d/1hTaNoVxeK5HBXI7FHMMPKznvILbudUpxgRslYouw34Q/pubhtml';

// Funkcja do pobierania danych z arkusza
async function fetchData() {
  try {
    const response = await fetch('https://docs.google.com/spreadsheets/d/1hTaNoVxeK5HBXI7FHMMPKznvILbudUpxgRslYouw34Q/pubhtml');
    const data = await response.text();

    // Parsuj dane HTML do struktury DOM
    const parser = new DOMParser();
    const doc = parser.parseFromString(data, 'text/html');

    // Znajdź tabelę danych w arkuszu
    const table = doc.querySelector('table');

    // Pobierz wszystkie wiersze z tabeli
    const rows = table.querySelectorAll('tbody tr');

    // Tworzenie kafli dla każdego wiersza
    const tilesContainer = document.getElementById('tiles-container');

    // Mapowanie obietnic do stworzenia kafli
    const tilePromises = Array.from(rows).map(async (row, index) => {
      const columns = row.querySelectorAll('td');
      const tile = await createTile(columns, index + 1); // Indeks wiersza zaczynając od 1
      return tile;
    });

    // Oczekiwanie na zakończenie wszystkich obietnic i dodanie kafli do kontenera
    const tiles = await Promise.all(tilePromises);
    tiles.forEach(tile => {
      tilesContainer.appendChild(tile);
    });

  } catch (error) {
    console.error('Błąd pobierania danych:', error);
  }
}

// Funkcja do tworzenia kafli na podstawie danych z wiersza
async function createTile(columns, row) {
  const wytwornia = columns[0].textContent.trim();
  const nr = columns[2].textContent.trim();
  const artystaZespol = columns[3].textContent.trim() + ' - ' + columns[4].textContent.trim();
  const discogsLink = columns[5].textContent.trim();
  const ilosc = parseInt(columns[6].textContent.trim());
  const uwagi = columns[7].textContent.trim();
  const dataNabycia = columns[8].textContent.trim();

  // Pobierz wartość koloru bezpośrednio z arkusza Google Sheets (kolumna 10)
  const kolor = columns[9].textContent.trim();

  // Utwórz element kafla
  const tile = document.createElement('div');
  tile.classList.add('tile');
  tile.style.backgroundColor = kolor;

  // Dodaj zawartość do kafla
  tile.innerHTML = `
    <h3>${wytwornia}</h3>
    <p><strong>${artystaZespol}</strong></p>
    <p>Nr: ${nr}</p>
    <p><a href="${discogsLink}" target="_blank">Link do Discogs</a></p>
    <p>Ilość: <strong>${ilosc}</strong></p>
    <p>${uwagi}</p>
    <p>Data nabycia: ${ilosc !== 0 ? dataNabycia : 'Brak'}</p>
  `;

  return tile;
}

// Pobierz dane po załadowaniu strony
window.onload = fetchData;
</script>

</body>
</html>
