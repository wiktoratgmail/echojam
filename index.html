<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kafle z Arkusza Google</title>
  <style>
    /* Dodaj stylizację kafli */
    .tile {
      border: 1px solid #ddd;
      padding: 10px;
      margin: 10px;
      width: 300px;
      float: left; /* Kaflowy układ - jeden obok drugiego */
    }

    .tile img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>

<div id="tiles-container"></div>

<script>
// Adres URL publicznego arkusza
// Adres URL publicznego arkusza
const sheetUrl = 'https://docs.google.com/spreadsheets/d/1hTaNoVxeK5HBXI7FHMMPKznvILbudUpxgRslYouw34Q/pubhtml';

// Funkcja do pobierania danych z arkusza
async function fetchData() {
  try {
    const response = await fetch(sheetUrl);
    const data = await response.text();

    // Parsuj dane HTML do struktury DOM
    const parser = new DOMParser();
    const doc = parser.parseFromString(data, 'text/html');

    // Znajdź tabelę danych w arkuszu
    const table = doc.querySelector('table');

    // Pobierz wszystkie wiersze z tabeli
    const rows = table.querySelectorAll('tbody tr');

    // Tworzenie kafli dla każdego wiersza
    const tilesContainer = document.getElementById('tiles-container');

    // Mapowanie obietnic do stworzenia kafli
    const tilePromises = Array.from(rows).map(async (row) => {
      const columns = row.querySelectorAll('td');
      const tile = await createTile(columns);
      return tile;
    });

    // Oczekiwanie na zakończenie wszystkich obietnic i dodanie kafli do kontenera
    const tiles = await Promise.all(tilePromises);
    tiles.forEach(tile => {
      tilesContainer.appendChild(tile);
    });

  } catch (error) {
    console.error('Błąd pobierania danych:', error);
  }
}

// Funkcja do tworzenia kafli na podstawie danych z wiersza
async function createTile(columns) {
  // ... (bez zmian)

  return new Promise((resolve) => {
    // Utwórz element kafla
    const tile = document.createElement('div');
    tile.classList.add('tile');
    tile.style.backgroundColor = kolor;

    // Dodaj zawartość do kafla
    tile.innerHTML = `
      <h3>${wytwornia}</h3>
      <p><strong>${artystaZespol}</strong></p>
      <p>Nr: ${nr}</p>
      <p><a href="${discogsLink}" target="_blank">Link do Discogs</a></p>
      <p>Ilość: <strong>${ilosc}</strong></p>
      <p>${uwagi}</p>
      <p>Data nabycia: ${ilosc !== 0 ? dataNabycia : 'Brak'}</p>
    `;

    resolve(tile);
  });
}

// ... (reszta kodu bez zmian)


// Funkcja do pobierania koloru tła komórki z arkusza Google Sheets
async function fetchBackgroundColor(column, value) {
  try {
    const response = await fetch(`https://script.google.com/macros/s/AKfycbz.../exec?column=${column}&value=${value}`);
    const data = await response.json();
    return data.backgroundColor;
  } catch (error) {
    console.error('Błąd pobierania koloru tła komórki:', error);
    // Domyślny kolor w przypadku błędu
    return '#ffffff';
  }
}

// Pobierz dane po załadowaniu strony
window.onload = fetchData;
</script>

</body>
</html>
